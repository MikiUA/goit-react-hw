"use strict";(self.webpackChunkreact_homework_template=self.webpackChunkreact_homework_template||[]).push([[621],{6470:function(e,n,t){t.d(n,{Z:function(){return a}});var r=t(184);function a(){return(0,r.jsx)("div",{children:"Loading ..."})}},7621:function(e,n,t){t.r(n),t.d(n,{default:function(){return de}});var r,a=t(2791),i=t(7689),o=t(5048),u=t(3433),s=t(4942),c=t(5273).configureStore,l=t(9672).contactsApi,d=t(885).userApi,m=t(2795),h=m.name,f=m.reducer;console.log(l,d);var p=c({reducer:(r={},(0,s.Z)(r,l.reducerPath,l.reducer),(0,s.Z)(r,d.reducerPath,d.reducer),(0,s.Z)(r,h,f),r),middleware:function(e){return[].concat((0,u.Z)(e()),[l.middleware,d.middleware])}}),x=t(885),g=t(889),j=t(9439),Z=t(5773),v=t(4953),b=t(9373),y=t(9672),C=t(2795),w="ContactFormOverlay_wrapper__9p4kF",S="ContactFormOverlay_overlay__FxGz4",k=t(184);function A(){var e=(0,o.v9)((function(e){return e[C.name]})),n=(0,a.useState)(""),t=(0,j.Z)(n,2),r=t[0],i=t[1],u=(0,a.useState)(""),s=(0,j.Z)(u,2),c=s[0],l=s[1],d=(0,a.useState)(!1),m=(0,j.Z)(d,2),h=m[0],f=m[1],p=(0,a.useState)(null),x=(0,j.Z)(p,2),g=x[0],A=x[1],T=(0,o.I0)(),M=(0,y.useAddContactMutation)(),P=(0,j.Z)(M,2),E=P[0],L=P[1],U=L.isSuccess,q=L.isLoading,I=L.isError,F=L.error,W=(0,y.useEditContactMutation)(),z=(0,j.Z)(W,2),D=z[0],_=z[1],Q=_.isSuccess,O=_.isLoading,G=_.isError,B=_.error;function N(){T((0,C.cancelEdit)()),A(null),f(!1)}(0,a.useEffect)((function(){(U||Q)&&N()}),[U,Q]),(0,a.useEffect)((function(){(q||O)&&f(!0)}),[q,O]),(0,a.useEffect)((function(){I&&A(F),G&&A(B)}),[I,G,F,B]),(0,a.useEffect)((function(){console.log("changed contact edit to :",e),i(e&&e.name||""),l(e&&e.number||"")}),[e]);var H="^[a-zA-Z\u0430-\u044f\u0410-\u042f]+(([' -][a-zA-Z\u0430-\u044f\u0410-\u042f ])?[a-zA-Z\u0430-\u044f\u0410-\u042f]*)*$",R="Name may contain only letters, apostrophe, dash and spaces. For example Adrian, Jacob Mercer, Charles de Batz de Castelmore d'Artagnan",J="/d{1,4}?[-.s]?(?d{1,3}?)?[-.s]?d{1,4}[-.s]?d{1,4}[-.s]?d{1,9}",$="Phone number must be digits and can contain spaces, dashes, parentheses and can start with +";return e?(0,k.jsx)("div",{className:w,children:(0,k.jsxs)("div",{className:S,children:[(0,k.jsxs)("form",{onSubmit:function(n){n.preventDefault(),A(null),e.id?D({id:e.id,name:r,number:c}):E({name:r,number:c})},children:[(0,k.jsx)(v.Z,{label:"name",value:r,onChange:function(e){return i(e.target.value)},inputProps:{pattern:H,title:R},required:!0}),(0,k.jsx)(v.Z,{label:"number",value:c,onChange:function(e){return l(e.target.value)},inputProps:{pattern:J,title:$},required:!0}),(0,k.jsx)(b.Z,{type:"submit",disabled:h,children:h?"Please wait":"Submit"}),(0,k.jsx)(b.Z,{type:"button",onClick:N,children:"cancel"})]}),g?(0,k.jsx)(Z.Z,{children:g.message}):""]})}):null}var T=t(4852),M=t(9900),P=t(3400),E=t(7195),L=t(8262),U=t(5397);function q(e){var n=e.contact,t=n.id,r=n.name,a=n.number,i=(0,o.I0)(),u=(0,y.useDeleteContactMutation)(),s=(0,j.Z)(u,2),c=s[0],l=s[1].isLoading;return(0,k.jsxs)(T.ZP,{children:[(0,k.jsx)(M.Z,{primary:r,secondary:a}),(0,k.jsx)(P.Z,{onClick:function(){i((0,C.editContact)({id:t,name:r,number:a}))},children:(0,k.jsx)(E.Z,{})}),(0,k.jsx)(P.Z,{onClick:function(){c({id:t})},disabled:l,children:l?(0,k.jsx)(L.Z,{}):(0,k.jsx)(U.Z,{})})]})}var I=t(493),F=t(6470);function W(){var e=(0,y.useGetContactsQuery)(),n=e.data,t=e.isLoading,r=(0,a.useState)(""),i=(0,j.Z)(r,2),o=i[0],u=i[1];return(0,k.jsxs)("div",{children:[(0,k.jsx)(v.Z,{type:"text",value:o,placeholder:"find a contact",onChange:function(e){return u(e.target.value.toUpperCase())}}),t?(0,k.jsx)(F.Z,{}):(0,k.jsx)(I.Z,{children:n.filter((function(e){return!!e.name.toUpperCase().includes(o)||!!e.number.toString().includes(o)})).map((function(e){return(0,k.jsx)(q,{contact:e},e.id)}))})]})}var z=t(7607),D=t(2840),_=t(4554),Q=t(4395),O=t(4663),G=t(1509),B=t(3903),N=t(890);function H(){var e=(0,x.useCheckUserQuery)().data,n=(0,x.useLogoutMutation)(),t=(0,j.Z)(n,2),r=t[0],i=t[1].isLoading,u=(0,o.I0)(),s=(0,a.useState)(null),c=(0,j.Z)(s,2),l=c[0],d=c[1];return(0,k.jsx)(_.Z,{sx:{flexGrow:1},children:(0,k.jsx)(Q.Z,{position:"static",children:(0,k.jsxs)(O.Z,{children:[(0,k.jsx)(P.Z,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2},onClick:function(e){d(e.currentTarget)},children:(0,k.jsx)(z.Z,{})}),(0,k.jsxs)(G.Z,{sx:{mt:"45px"},id:"menu-appbar",anchorEl:l,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(l),onClose:function(){d(null)},children:[(0,k.jsx)(M.Z,{primary:e.name,secondary:e.email}),(0,k.jsx)(B.Z,{onClick:function(){r()},disabled:i,children:(0,k.jsx)(N.Z,{textAlign:"center",children:"Logout"})})]}),(0,k.jsx)(N.Z,{variant:"h6",component:"div",sx:{flexGrow:1},children:"Contacts"}),(0,k.jsx)(P.Z,{color:"inherit",onClick:function(){u((0,C.addContact)())},children:(0,k.jsx)(D.Z,{})})]})})})}function R(){return(0,k.jsxs)(g.Z,{type:"task",title:(0,k.jsx)(H,{}),children:[(0,k.jsx)(W,{}),(0,k.jsx)(A,{})]})}var J=t(533),$=t(1889),K=t(1413),V=t(3044),X=t(4708),Y=t(403),ee=t(1614);function ne(e){return(0,k.jsxs)(N.Z,(0,K.Z)((0,K.Z)({variant:"body2",color:"text.secondary",align:"center"},e),{},{children:["Website created by ",(0,k.jsx)(J.Z,{color:"inherit",href:"https://github.com/MikiUA/",children:"MikiUA"})," ","2023."]}))}function te(e){var n=e.handleSubmit,t=e.title,r=e.children;return(0,k.jsxs)(ee.Z,{component:"main",maxWidth:"xs",children:[(0,k.jsx)(X.ZP,{}),(0,k.jsxs)(_.Z,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,k.jsx)(V.Z,{sx:{m:1,bgcolor:"secondary.main"},children:(0,k.jsx)(Y.Z,{})}),(0,k.jsx)(N.Z,{component:"h1",variant:"h5",children:t}),(0,k.jsx)(_.Z,{component:"form",onSubmit:n,sx:{mt:1},children:r})]}),(0,k.jsx)(ne,{sx:{mt:8,mb:4}})]})}var re=function(){return(0,k.jsx)(v.Z,(0,K.Z)((0,K.Z)({},{margin:"normal",required:!0,fullWidth:!0}),{},{label:"Username",name:"username",autoComplete:"username"}))},ae=function(){return(0,k.jsx)(v.Z,(0,K.Z)((0,K.Z)({},{margin:"normal",required:!0,fullWidth:!0}),{},{label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0}))},ie=function(){return(0,k.jsx)(v.Z,(0,K.Z)((0,K.Z)({},{margin:"normal",required:!0,fullWidth:!0}),{},{name:"password",label:"Password",type:"password",autoComplete:"current-password"}))},oe=t(1087);function ue(){var e=(0,x.useLoginMutation)(),n=(0,j.Z)(e,2),t=n[0],r=n[1].isLoading;return(0,k.jsxs)(te,{handleSubmit:function(e){e.preventDefault();var n=new FormData(e.currentTarget),r={email:n.get("email"),password:n.get("password")};console.log(r),t(r)},title:"Sign In",children:[(0,k.jsx)(ae,{}),(0,k.jsx)(ie,{}),(0,k.jsx)(b.Z,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:r,children:r?"please wait":"Sign In"}),(0,k.jsxs)($.ZP,{container:!0,children:[(0,k.jsx)($.ZP,{item:!0,xs:!0,children:(0,k.jsx)(J.Z,{variant:"body2",onClick:function(){alert("Too bad, we can not recover your password")},children:"Forgot password?"})}),(0,k.jsx)($.ZP,{item:!0,children:(0,k.jsx)(oe.rU,{to:"../signup",children:(0,k.jsx)(J.Z,{variant:"body2",children:"Don't have an account? Sign Up"})})})]})]})}var se=t(5523),ce=t(9174);function le(){var e=(0,x.useSignupMutation)(),n=(0,j.Z)(e,2),t=n[0],r=n[1].isLoading;return(0,k.jsxs)(te,{handleSubmit:function(e){e.preventDefault();var n=new FormData(e.currentTarget),r={name:n.get("username"),email:n.get("email"),password:n.get("password")};console.log(r),t(r)},title:"Sign Up",children:[(0,k.jsx)(ae,{}),(0,k.jsx)(re,{}),(0,k.jsx)(ie,{}),(0,k.jsx)(se.Z,{control:(0,k.jsx)(ce.Z,{value:"allowExtraEmails",color:"primary",checked:!1,onChange:function(){alert("No you don't")}}),label:"I want to receive inspiration, marketing promotions and updates via email."}),(0,k.jsx)(b.Z,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:r,children:r?"Please wait":"Sign Up"}),(0,k.jsx)($.ZP,{container:!0,justifyContent:"flex-end",children:(0,k.jsx)($.ZP,{item:!0,children:(0,k.jsx)(oe.rU,{to:"../login",children:(0,k.jsx)(J.Z,{variant:"body2",children:"Already have an account? Sign in"})})})})]})}function de(){return(0,k.jsx)(o.zt,{store:p,children:(0,k.jsx)(he,{})})}var me=function(e){return e?(0,k.jsxs)(i.Z5,{children:[(0,k.jsx)(i.AW,{path:"/",element:(0,k.jsx)(R,{})}),(0,k.jsx)(i.AW,{path:"/*",element:(0,k.jsx)(i.Fg,{to:"./",replace:!0})})]}):(0,k.jsxs)(i.Z5,{children:[(0,k.jsx)(i.AW,{path:"/login",element:(0,k.jsx)(ue,{})}),(0,k.jsx)(i.AW,{path:"/signup",element:(0,k.jsx)(le,{})}),(0,k.jsx)(i.AW,{path:"/*",element:(0,k.jsx)(i.Fg,{to:"./login",replace:!0})})]})};function he(){var e=(0,x.useCheckUserQuery)(),n=e.data,t=e.status;return"pending"===t?(0,k.jsx)(F.Z,{}):me("rejected"===t?null:n)}},1290:function(e,n,t){t.d(n,{b:function(){return r},u:function(){return a}});var r=function(){return localStorage.getItem("authToken")},a=function(e){localStorage.setItem("authToken",e)}},9672:function(e,n,t){t.r(n),t.d(n,{contactsApi:function(){return c},useAddContactMutation:function(){return d},useDeleteContactMutation:function(){return h},useEditContactMutation:function(){return m},useGetContactsQuery:function(){return l}});var r=t(5987),a=t(1465),i=t(255),o=t(1290),u=["id"],s="/contacts",c=(0,a.LC)({reducerPath:"contacts",baseQuery:(0,i.ni)({baseUrl:"https://connections-api.herokuapp.com",prepareHeaders:function(e){var n=(0,o.b)();if(n)return e.set("authorization","Bearer ".concat(n)),e}}),tagTypes:["contacts"],endpoints:function(e){return{getContacts:e.query({query:function(){return s},providesTags:["contacts"]}),addContact:e.mutation({query:function(e){return{url:s,method:"POST",body:e}},invalidatesTags:["contacts"]}),deleteContact:e.mutation({query:function(e){return{url:"/contacts/"+e.id,method:"DELETE"}},invalidatesTags:["contacts"]}),editContact:e.mutation({query:function(e){return{url:"/contacts/"+e.id,method:"PATCH",body:(0,r.Z)(e,u)}},invalidatesTags:["contacts"]})}}}),l=c.useGetContactsQuery,d=c.useAddContactMutation,m=c.useEditContactMutation,h=c.useDeleteContactMutation},2795:function(e,n,t){t.r(n),t.d(n,{addContact:function(){return i},cancelEdit:function(){return u},editContact:function(){return o},name:function(){return a},reducer:function(){return c}});var r=t(5273),a="contactFormItem",i=(0,r.createAction)(a+"/addItem"),o=(0,r.createAction)(a+"/editItem"),u=(0,r.createAction)(a+"/resetItem"),s=function(e){return e&&e.id&&e.name&&e.number?{id:e.id,name:e.name,number:e.number}:null};function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;switch(console.log("on the item ",e,"\n we will do ",n),n.type){case i.type:return{name:"",number:""};case o.type:return s(n.payload)||null;case u.type:return null;default:return e}}},885:function(e,n,t){t.r(n),t.d(n,{useCheckUserQuery:function(){return d},useLoginMutation:function(){return s},useLogoutMutation:function(){return c},useSignupMutation:function(){return l},userApi:function(){return u}});var r=t(1465),a=t(255),i=t(1290),o=function(e,n,t){return(0,i.u)(e.token),e.user},u=(0,r.LC)({reducerPath:"user",baseQuery:(0,a.ni)({baseUrl:"https://connections-api.herokuapp.com",prepareHeaders:function(e){var n=(0,i.b)();if(n)return e.set("authorization","Bearer ".concat(n)),e}}),tagTypes:["contacts"],endpoints:function(e){return{checkUser:e.query({query:function(){return"/users/current"},providesTags:["user"]}),login:e.mutation({query:function(e){return{url:"/users/login",method:"POST",body:e}},transformResponse:o,invalidatesTags:function(e){return e?["user"]:[]}}),signup:e.mutation({query:function(e){return{url:"/users/signup",method:"POST",body:e}},transformResponse:o,invalidatesTags:function(e){return e?["user"]:[]}}),logout:e.mutation({query:function(){return{url:"/users/logout",method:"POST"}},transformResponse:function(){return null},invalidatesTags:["user"]})}}}),s=u.useLoginMutation,c=u.useLogoutMutation,l=u.useSignupMutation,d=u.useCheckUserQuery}}]);
//# sourceMappingURL=621.59de91cb.chunk.js.map