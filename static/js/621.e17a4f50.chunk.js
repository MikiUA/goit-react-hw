"use strict";(self.webpackChunkreact_homework_template=self.webpackChunkreact_homework_template||[]).push([[621],{6470:function(e,n,t){t.d(n,{Z:function(){return a}});var r=t(184);function a(){return(0,r.jsx)("div",{children:"Loading ..."})}},7621:function(e,n,t){t.r(n),t.d(n,{default:function(){return me}});var r,a=t(2791),i=t(7689),o=t(5048),s=t(3433),u=t(4942),c=t(5273).configureStore,l=t(9672).contactsApi,d=t(885).userApi,m=t(2795),h=m.name,p=m.reducer;console.log(l,d);var f=c({reducer:(r={},(0,u.Z)(r,l.reducerPath,l.reducer),(0,u.Z)(r,d.reducerPath,d.reducer),(0,u.Z)(r,h,p),r),middleware:function(e){return[].concat((0,s.Z)(e()),[l.middleware,d.middleware])}}),x=t(885),g=t(889),Z=t(9439),j=t(5773),v=t(4953),b=t(9373),y=t(9672),C=t(2795),A="ContactFormOverlay_wrapper__9p4kF",k="ContactFormOverlay_overlay__FxGz4",w=t(184);function S(){var e=(0,o.v9)((function(e){return e[C.name]})),n=(0,a.useState)(""),t=(0,Z.Z)(n,2),r=t[0],i=t[1],s=(0,a.useState)(""),u=(0,Z.Z)(s,2),c=u[0],l=u[1],d=(0,a.useState)(!1),m=(0,Z.Z)(d,2),h=m[0],p=m[1],f=(0,a.useState)(null),x=(0,Z.Z)(f,2),g=x[0],S=x[1],z=(0,o.I0)(),P=(0,y.useAddContactMutation)(),M=(0,Z.Z)(P,2),T=M[0],E=M[1],L=E.isSuccess,U=E.isLoading,q=E.isError,F=E.error,I=(0,y.useEditContactMutation)(),_=(0,Z.Z)(I,2),D=_[0],W=_[1],Q=W.isSuccess,O=W.isLoading,G=W.isError,B=W.error;function N(){z((0,C.cancelEdit)()),S(null),p(!1)}(0,a.useEffect)((function(){(L||Q)&&N()}),[L,Q]),(0,a.useEffect)((function(){(U||O)&&p(!0)}),[U,O]),(0,a.useEffect)((function(){q&&S(F),G&&S(B)}),[q,G,F,B]),(0,a.useEffect)((function(){console.log("changed contact edit to :",e),i(e&&e.name||""),l(e&&e.number||"")}),[e]);var $="^[a-zA-Z\u0430-\u044f\u0410-\u042f]+(([' -][a-zA-Z\u0430-\u044f\u0410-\u042f ])?[a-zA-Z\u0430-\u044f\u0410-\u042f]*)*$",H="Name may contain only letters, apostrophe, dash and spaces. For example Adrian, Jacob Mercer, Charles de Batz de Castelmore d'Artagnan",R="/d{1,4}?[-.s]?(?d{1,3}?)?[-.s]?d{1,4}[-.s]?d{1,4}[-.s]?d{1,9}",J="Phone number must be digits and can contain spaces, dashes, parentheses and can start with +";return e?(0,w.jsx)("div",{className:A,children:(0,w.jsxs)("div",{className:k,children:[(0,w.jsxs)("form",{onSubmit:function(n){n.preventDefault(),S(null),e.id?D({id:e.id,name:r,number:c}):T({name:r,number:c})},children:[(0,w.jsx)(v.Z,{label:"name",value:r,onChange:function(e){return i(e.target.value)},inputProps:{pattern:$,title:H},required:!0}),(0,w.jsx)(v.Z,{label:"number",value:c,onChange:function(e){return l(e.target.value)},inputProps:{pattern:R,title:J},required:!0}),(0,w.jsx)(b.Z,{type:"submit",disabled:h,children:h?"Please wait":"Submit"}),(0,w.jsx)(b.Z,{type:"button",onClick:N,children:"cancel"})]}),g?(0,w.jsx)(j.Z,{children:g.message}):""]})}):null}var z=t(4852),P=t(9900),M=t(3400),T=t(7195),E=t(8262),L=t(5397);function U(e){var n=e.contact,t=n.id,r=n.name,a=n.number,i=(0,o.I0)(),s=(0,y.useDeleteContactMutation)(),u=(0,Z.Z)(s,2),c=u[0],l=u[1].isLoading;return(0,w.jsxs)(z.ZP,{children:[(0,w.jsx)(P.Z,{primary:r,secondary:a}),(0,w.jsx)(M.Z,{onClick:function(){i((0,C.editContact)({id:t,name:r,number:a}))},children:(0,w.jsx)(T.Z,{})}),(0,w.jsx)(M.Z,{onClick:function(){c({id:t})},disabled:l,children:l?(0,w.jsx)(E.Z,{}):(0,w.jsx)(L.Z,{})})]})}var q=t(493),F=t(6470);function I(){var e=(0,y.useGetContactsQuery)(),n=e.data,t=e.isLoading,r=(0,a.useState)(""),i=(0,Z.Z)(r,2),o=i[0],s=i[1];return(0,w.jsxs)("div",{children:[(0,w.jsx)(v.Z,{type:"text",value:o,placeholder:"find a contact",onChange:function(e){return s(e.target.value.toUpperCase())}}),t?(0,w.jsx)(F.Z,{}):(0,w.jsx)(q.Z,{children:n.filter((function(e){return!!e.name.toUpperCase().includes(o)||!!e.number.toString().includes(o)})).map((function(e){return(0,w.jsx)(U,{contact:e},e.id)}))})]})}var _=t(7607),D=t(2840),W=t(4554),Q=t(4395),O=t(4663),G=t(1509),B=t(3903),N=t(890);function $(){var e=(0,x.useCheckUserQuery)().data,n=(0,x.useLogoutMutation)(),t=(0,Z.Z)(n,2),r=t[0],i=t[1].isLoading,s=(0,o.I0)(),u=(0,a.useState)(null),c=(0,Z.Z)(u,2),l=c[0],d=c[1];return(0,w.jsx)(W.Z,{sx:{flexGrow:1},children:(0,w.jsx)(Q.Z,{position:"static",children:(0,w.jsxs)(O.Z,{children:[(0,w.jsx)(M.Z,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2},onClick:function(e){d(e.currentTarget)},children:(0,w.jsx)(_.Z,{})}),(0,w.jsxs)(G.Z,{sx:{mt:"45px"},id:"menu-appbar",anchorEl:l,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(l),onClose:function(){d(null)},children:[(0,w.jsx)(P.Z,{primary:e.name,secondary:e.email}),(0,w.jsx)(B.Z,{onClick:function(){r()},disabled:i,children:(0,w.jsx)(N.Z,{textAlign:"center",children:"Logout"})})]}),(0,w.jsx)(N.Z,{variant:"h6",component:"div",sx:{flexGrow:1},children:"Contacts"}),(0,w.jsx)(M.Z,{color:"inherit",onClick:function(){s((0,C.addContact)())},children:(0,w.jsx)(D.Z,{})})]})})})}function H(){return(0,w.jsxs)(g.Z,{type:"task",title:(0,w.jsx)($,{}),children:[(0,w.jsx)(I,{}),(0,w.jsx)(S,{})]})}var R=t(533),J=t(1889),K=t(1413),V=t(3044),X=t(4708),Y=t(403),ee=t(1614);function ne(e){return(0,w.jsxs)(N.Z,(0,K.Z)((0,K.Z)({variant:"body2",color:"text.secondary",align:"center"},e),{},{children:["Website created by ",(0,w.jsx)(R.Z,{color:"inherit",href:"https://github.com/MikiUA/",children:"MikiUA"})," ","2023."]}))}function te(e){var n=e.handleSubmit,t=e.title,r=e.children;return(0,w.jsxs)(ee.Z,{component:"main",maxWidth:"xs",children:[(0,w.jsx)(X.ZP,{}),(0,w.jsxs)(W.Z,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,w.jsx)(V.Z,{sx:{m:1,bgcolor:"secondary.main"},children:(0,w.jsx)(Y.Z,{})}),(0,w.jsx)(N.Z,{component:"h1",variant:"h5",children:t}),(0,w.jsx)(W.Z,{component:"form",onSubmit:n,sx:{mt:1},children:r})]}),(0,w.jsx)(ne,{sx:{mt:8,mb:4}})]})}var re=function(e,n){return{margin:"normal",required:!0,fullWidth:!0,inputProps:{pattern:e,title:n}}},ae=function(){return(0,w.jsx)(v.Z,(0,K.Z)((0,K.Z)({},re("^[a-zA-Z\u0430-\u044f\u0410-\u042f]+(([' -][a-zA-Z\u0430-\u044f\u0410-\u042f ])?[a-zA-Z\u0430-\u044f\u0410-\u042f]*)*$","Name may contain only letters, apostrophe, dash and spaces. For example Adrian, Jacob Mercer, Charles de Batz de Castelmore d'Artagnan")),{},{label:"Username",name:"username",autoComplete:"username"}))},ie=function(){return(0,w.jsx)(v.Z,(0,K.Z)((0,K.Z)({},re("[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?","Please enter a valid email address")),{},{label:"Email Address",name:"email",autoComplete:"email",autoFocus:!0}))},oe=function(){return(0,w.jsx)(v.Z,(0,K.Z)((0,K.Z)({},re("^[a-zA-Z\u0430-\u044f\u0410-\u042f]+(([' -][a-zA-Z\u0430-\u044f\u0410-\u042f ])?[a-zA-Z\u0430-\u044f\u0410-\u042f]*)*$","fuck")),{},{name:"password",label:"Password",autoComplete:"current-password"}))},se=t(1087);function ue(){var e=(0,x.useLoginMutation)(),n=(0,Z.Z)(e,2),t=n[0],r=n[1].isLoading;return(0,w.jsxs)(te,{handleSubmit:function(e){e.preventDefault();var n=new FormData(e.currentTarget),r={email:n.get("email"),password:n.get("password")};console.log(r),t(r)},title:"Sign In",children:[(0,w.jsx)(ie,{}),(0,w.jsx)(oe,{}),(0,w.jsx)(b.Z,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:r,children:r?"please wait":"Sign In"}),(0,w.jsxs)(J.ZP,{container:!0,children:[(0,w.jsx)(J.ZP,{item:!0,xs:!0,children:(0,w.jsx)(R.Z,{variant:"body2",onClick:function(){alert("Too bad, we can not recover your password")},children:"Forgot password?"})}),(0,w.jsx)(J.ZP,{item:!0,children:(0,w.jsx)(se.rU,{to:"../signup",children:(0,w.jsx)(R.Z,{variant:"body2",children:"Don't have an account? Sign Up"})})})]})]})}var ce=t(5523),le=t(9174);function de(){var e=(0,x.useSignupMutation)(),n=(0,Z.Z)(e,2),t=n[0],r=n[1].isLoading;return(0,w.jsxs)(te,{handleSubmit:function(e){e.preventDefault();var n=new FormData(e.currentTarget),r={name:n.get("username"),email:n.get("email"),password:n.get("password")};console.log(r),t(r)},title:"Sign Up",children:[(0,w.jsx)(ie,{}),(0,w.jsx)(ae,{}),(0,w.jsx)(oe,{}),(0,w.jsx)(ce.Z,{control:(0,w.jsx)(le.Z,{value:"allowExtraEmails",color:"primary",checked:!1,onChange:function(){alert("No you don't")}}),label:"I want to receive inspiration, marketing promotions and updates via email."}),(0,w.jsx)(b.Z,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},disabled:r,children:r?"Please wait":"Sign Up"}),(0,w.jsx)(J.ZP,{container:!0,justifyContent:"flex-end",children:(0,w.jsx)(J.ZP,{item:!0,children:(0,w.jsx)(se.rU,{to:"../login",children:(0,w.jsx)(R.Z,{variant:"body2",children:"Already have an account? Sign in"})})})})]})}function me(){return(0,w.jsx)(o.zt,{store:f,children:(0,w.jsx)(pe,{})})}var he=function(e){return e?(0,w.jsxs)(i.Z5,{children:[(0,w.jsx)(i.AW,{path:"/",element:(0,w.jsx)(H,{})}),(0,w.jsx)(i.AW,{path:"/*",element:(0,w.jsx)(i.Fg,{to:"./",replace:!0})})]}):(0,w.jsxs)(i.Z5,{children:[(0,w.jsx)(i.AW,{path:"/login",element:(0,w.jsx)(ue,{})}),(0,w.jsx)(i.AW,{path:"/signup",element:(0,w.jsx)(de,{})}),(0,w.jsx)(i.AW,{path:"/*",element:(0,w.jsx)(i.Fg,{to:"./login",replace:!0})})]})};function pe(){var e=(0,x.useCheckUserQuery)(),n=e.data,t=e.status;return"pending"===t?(0,w.jsx)(F.Z,{}):he("rejected"===t?null:n)}},1290:function(e,n,t){t.d(n,{b:function(){return r},u:function(){return a}});var r=function(){return localStorage.getItem("authToken")},a=function(e){localStorage.setItem("authToken",e)}},9672:function(e,n,t){t.r(n),t.d(n,{contactsApi:function(){return c},useAddContactMutation:function(){return d},useDeleteContactMutation:function(){return h},useEditContactMutation:function(){return m},useGetContactsQuery:function(){return l}});var r=t(5987),a=t(1465),i=t(255),o=t(1290),s=["id"],u="/contacts",c=(0,a.LC)({reducerPath:"contacts",baseQuery:(0,i.ni)({baseUrl:"https://connections-api.herokuapp.com",prepareHeaders:function(e){var n=(0,o.b)();if(n)return e.set("authorization","Bearer ".concat(n)),e}}),tagTypes:["contacts"],endpoints:function(e){return{getContacts:e.query({query:function(){return u},providesTags:["contacts"]}),addContact:e.mutation({query:function(e){return{url:u,method:"POST",body:e}},invalidatesTags:["contacts"]}),deleteContact:e.mutation({query:function(e){return{url:"/contacts/"+e.id,method:"DELETE"}},invalidatesTags:["contacts"]}),editContact:e.mutation({query:function(e){return{url:"/contacts/"+e.id,method:"PATCH",body:(0,r.Z)(e,s)}},invalidatesTags:["contacts"]})}}}),l=c.useGetContactsQuery,d=c.useAddContactMutation,m=c.useEditContactMutation,h=c.useDeleteContactMutation},2795:function(e,n,t){t.r(n),t.d(n,{addContact:function(){return i},cancelEdit:function(){return s},editContact:function(){return o},name:function(){return a},reducer:function(){return c}});var r=t(5273),a="contactFormItem",i=(0,r.createAction)(a+"/addItem"),o=(0,r.createAction)(a+"/editItem"),s=(0,r.createAction)(a+"/resetItem"),u=function(e){return e&&e.id&&e.name&&e.number?{id:e.id,name:e.name,number:e.number}:null};function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;switch(console.log("on the item ",e,"\n we will do ",n),n.type){case i.type:return{name:"",number:""};case o.type:return u(n.payload)||null;case s.type:return null;default:return e}}},885:function(e,n,t){t.r(n),t.d(n,{useCheckUserQuery:function(){return d},useLoginMutation:function(){return u},useLogoutMutation:function(){return c},useSignupMutation:function(){return l},userApi:function(){return s}});var r=t(1465),a=t(255),i=t(1290),o=function(e,n,t){return(0,i.u)(e.token),e.user},s=(0,r.LC)({reducerPath:"user",baseQuery:(0,a.ni)({baseUrl:"https://connections-api.herokuapp.com",prepareHeaders:function(e){var n=(0,i.b)();if(n)return e.set("authorization","Bearer ".concat(n)),e}}),tagTypes:["contacts"],endpoints:function(e){return{checkUser:e.query({query:function(){return"/users/current"},providesTags:["user"]}),login:e.mutation({query:function(e){return{url:"/users/login",method:"POST",body:e}},transformResponse:o,invalidatesTags:["user"]}),signup:e.mutation({query:function(e){return{url:"/users/signup",method:"POST",body:e}},transformResponse:o,invalidatesTags:["user"]}),logout:e.mutation({query:function(){return{url:"/users/logout",method:"POST"}},transformResponse:function(){return null},invalidatesTags:["user"]})}}}),u=s.useLoginMutation,c=s.useLogoutMutation,l=s.useSignupMutation,d=s.useCheckUserQuery}}]);
//# sourceMappingURL=621.e17a4f50.chunk.js.map